% Copyright 2012, 2013 by Steffen Banhardt <latex-gender@steffenbanhardt.de>
%
% This work may be distributed and/or modified under the conditions of the LaTeX Project Public License, either version 1.3c of this license or (at your option) any later version. The latest version of this license is in
%
%    http://www.latex-project.org/lppl.txt
%
% and version 1.3c or later is part of all distributions of LaTeX version 2005/12/01 or later.
%
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{gender}[2013/10/18 V0.6 -- malefirst als Option]
%
\RequirePackage{xkeyval}
%
% Wird konj aufgerufen wird gndr@konj auf 'Wert', ansonsten auf 'und' gesetzt
\DeclareOptionX[GN]<gndr>{konj}[und]{\def\gndr@konj{#1}\PackageInfo{GENDER}{Setting 'gndr@konj' to '#1'}}
%
% Boolean 'single'
\define@boolkey+[GN]{gndr}{single}[true]%
    {\PackageInfo{GENDER}{Setting boolean 'single' to '#1'}}
    {\PackageWarning{GENDER}{Value #1 for 'single' ignored}}
%Setzt GN@gndr@single wenn es nicht aufgerufen wurde
\presetkeys[GN]{gndr}{single=false}{}
%
\define@boolkey+[GN]{gndr}{malefirst}[true]%
    {\PackageInfo{GENDER}{Setting boolean 'malefirst' to '#1'}}
    {\PackageWarning{GENDER}{Value #1 for 'malefirst' ignored}}
\presetkeys[GN]{gndr}{malefirst=false}{}
%
\DeclareOptionX*{\PackageWarning{GENDER}{Unknown Option '\CurrentOption'}}
\ProcessOptionsX[GN]<gndr>\relax
%
%-----------------------------
%
% Wurde konj nicht aufgerufen, wird es nun auf 'und' gesetzt
\@ifundefined{gndr@konj}{\def\gndr@konj{und}\PackageInfo{GENDER}{Setting 'gndr@konj' to 'und'}}{\relax}%
%
%
\newif\iffem\femtrue%female vorne
\newif\ifuc\uctrue%uppercase
\ifGN@gndr@malefirst\global\femfalse\fi
%
    %%%\newcommand{\test}{%test}
    %%%Test auf single: \ifGN@gndr@single TRUE \else FALSE \fi \\
    %%%}
%
\def\keep{\iffem\global\femfalse\else\global\femtrue\fi}%
%
\def\gender#1{\global\ucfalse\ifGN@gndr@single\@gend#1\@nil\else\@gender#1\@nil\fi}%
\def\Gender#1{\global\uctrue\ifGN@gndr@single\@gend#1\@nil\else\@gender#1\@nil\fi}%
\def\gend#1{\global\ucfalse\@gend#1\@nil}%
\def\Gend#1{\global\uctrue\@gend#1\@nil}%
%Version mit b -- es werden immer beide Formen genommen, auch bei single=true
\def\genderb#1{\global\ucfalse\@gender#1\@nil}%
\def\Genderb#1{\global\uctrue\@gender#1\@nil}%
%Versionen mit k -- die Form wird behalten
\def\genderk#1{\keep\global\ucfalse\ifGN@gndr@single\@gend#1\@nil\else\@gender#1\@nil\fi}%
\def\Genderk#1{\keep\global\uctrue\ifGN@gndr@single\@gend#1\@nil\else\@gender#1\@nil\fi}%
\def\gendk#1{\keep\global\ucfalse\@gend#1\@nil}%
\def\Gendk#1{\keep\global\uctrue\@gend#1\@nil}%
\def\genderbk#1{\keep\global\ucfalse\@gender#1\@nil}%
\def\Genderbk#1{\keep\global\uctrue\@gender#1\@nil}%
%
%
\def\@gender#1(#2)#3\@nil{%
    \if\relax\detokenize{#2}\relax%
    \def\gndr@ko{\gndr@konj}%
    \else\def\gndr@ko{#2}%
    \fi%
    \iffem%
	\ifuc\MakeUppercase#1 \else#1 \fi\gndr@ko{} #3%
	\global\femfalse%
    \else%
	\ifuc\MakeUppercase#3 \else#3 \fi\gndr@ko{} #1%
	\global\femtrue%
    \fi%
}
%
\def\@gend#1(#2)#3\@nil{%
    \iffem%
	\ifuc\MakeUppercase#1\else#1\fi%
	\global\femfalse%
    \else%
	\ifuc\MakeUppercase#3\else#3\fi%
	\global\femtrue%
    \fi%
}
%
% Weitere Formen
% Dürfen nicht die @Versionen aufrufen!
\newcommand{\gnd}[2][\gndr@konj]{\gender{#2in(#1)#2}} %Kurzbefehl \gnd[konj]{neutr. Form}
\newcommand{\gndpl}[2][\gndr@konj]{\gender{#2innen(#1)#2}} %Kurzbefehl \gndpl[konj]{neutr. Form}
%
%Pronomen
\newcommand{\sieer}[1][\gndr@konj]{\gender{sie(#1)er}}
\newcommand{\ersie}{\sieer}
\newcommand{\ihrsein}[1][\gndr@konj]{\gender{ihr(#1)sein}}
\newcommand{\seinihr}{\ihrsein}
\newcommand{\ihreseine}[1][\gndr@konj]{\gender{ihre(#1)seine}}
\newcommand{\seineihre}{\ihreseine}
\newcommand{\ihrihm}[1][\gndr@konj]{\gender{ihr(#1)ihm}}
\newcommand{\ihmihr}{\ihrihm}
\newcommand{\sieihn}[1][\gndr@konj]{\gender{sie(#1)ihn}}
\newcommand{\ihnsie}{\sieihn}
%Großschreibung
\newcommand{\Sieer}[1][\gndr@konj]{\Gender{sie(#1)er}}
\newcommand{\Ersie}{\Sieer}
\newcommand{\Ihrsein}[1][\gndr@konj]{\Gender{ihr(#1)sein}}
\newcommand{\Seinihr}{\Ihrsein}
\newcommand{\Ihreseine}[1][\gndr@konj]{\Gender{ihre(#1)seine}}
\newcommand{\Seineihre}{\Ihreseine}
\newcommand{\Ihrihm}[1][\gndr@konj]{\Gender{ihr(#1)ihm}}
\newcommand{\Ihmihr}{\Ihrihm}
\newcommand{\Sieihn}[1][\gndr@konj]{\Gender{sie(#1)ihn}}
\newcommand{\Ihnsie}{\Sieihn}

